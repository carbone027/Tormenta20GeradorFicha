<%- include('../partials/header', { title: 'RaÃ§as de Arton', activePage: 'races' }) %>

<section class="content-section active">
  <h2>ğŸ§ RaÃ§as de Arton</h2>
  <p style="text-align: center; margin-bottom: 2rem; color: #b8b8b8;">
    As raÃ§as de Arton sÃ£o muito variadas entre si. Na maior parte do mundo civilizado um personagem nÃ£o serÃ¡ hostilizado por pertencer a qualquer raÃ§a. Contudo, algumas raÃ§as sÃ£o mais numerosas que outras, e hÃ¡ aquelas consideradas mÃ­ticas ou extintas.
  </p>

  <!-- Filtros de RaÃ§as -->
  <div class="race-filters" style="margin-bottom: 3rem;">
    <div class="card" style="text-align: center; padding: 1.5rem;">
      <h3 style="color: var(--accent-gold); margin-bottom: 1rem;">ğŸ” Filtrar RaÃ§as</h3>
      <div class="filter-buttons" style="display: flex; flex-wrap: wrap; justify-content: center; gap: 0.8rem;">
        <button class="filter-btn active" data-filter="all">Todas as RaÃ§as</button>
        <button class="filter-btn" data-filter="comuns">ğŸ˜ï¸ Comuns</button>
        <button class="filter-btn" data-filter="raras">âœ¨ Raras</button>
        <button class="filter-btn" data-filter="extraplanares">ğŸŒŸ Extraplanares</button>
        <button class="filter-btn" data-filter="monstruosas">ğŸ‘¹ Monstruosas</button>
      </div>
    </div>
  </div>

  <% if (racas && racas.length > 0) { %>
    <div class="racas-grid">
      <% racas.forEach(raca => { %>
        <% 
          // Categorizar raÃ§as
          let categoria = 'comuns';
          let iconeRaca = 'ğŸ‘¤';
          
          switch(raca.nome.toLowerCase()) {
            case 'humano':
              categoria = 'comuns';
              iconeRaca = 'ğŸ‘¤';
              break;
            case 'anÃ£o':
              categoria = 'comuns';
              iconeRaca = 'â›ï¸';
              break;
            case 'elfo':
              categoria = 'comuns';
              iconeRaca = 'ğŸ§';
              break;
            case 'dahllan':
              categoria = 'comuns';
              iconeRaca = 'ğŸŒ¿';
              break;
            case 'goblin':
              categoria = 'comuns';
              iconeRaca = 'ğŸ‘º';
              break;
            case 'minotauro':
              categoria = 'comuns';
              iconeRaca = 'ğŸ‚';
              break;
            case 'qareen':
              categoria = 'comuns';
              iconeRaca = 'ğŸ§';
              break;
            case 'lefou':
              categoria = 'comuns';
              iconeRaca = 'ğŸ˜ˆ';
              break;
            case 'hynne':
              categoria = 'raras';
              iconeRaca = 'ğŸ€';
              break;
            case 'golem':
              categoria = 'raras';
              iconeRaca = 'ğŸ—¿';
              break;
            case 'kliren':
              categoria = 'raras';
              iconeRaca = 'ğŸ”§';
              break;
            case 'sereia/tritÃ£o':
              categoria = 'raras';
              iconeRaca = 'ğŸ§œ';
              break;
            case 'sÃ­lfide':
              categoria = 'extraplanares';
              iconeRaca = 'ğŸ§š';
              break;
            case 'suraggel (aggelus)':
              categoria = 'extraplanares';
              iconeRaca = 'ğŸ˜‡';
              break;
            case 'suraggel (sulfure)':
              categoria = 'extraplanares';
              iconeRaca = 'ğŸ˜ˆ';
              break;
            case 'medusa':
              categoria = 'monstruosas';
              iconeRaca = 'ğŸ';
              break;
            case 'osteon':
              categoria = 'monstruosas';
              iconeRaca = 'ğŸ’€';
              break;
            case 'trog':
              categoria = 'monstruosas';
              iconeRaca = 'ğŸ¦';
              break;
            default:
              categoria = 'raras';
              iconeRaca = 'â“';
          }
        %>
        
        <div class="raca-card" data-categoria="<%= categoria %>">
          <div class="raca-header">
            <div class="raca-icon" style="font-size: 3rem; margin-bottom: 0.5rem;"><%= iconeRaca %></div>
            <h3><%= raca.nome %></h3>
            <div class="raca-categoria-badge" style="
              background: <%= categoria === 'comuns' ? 'var(--success-green)' : 
                            categoria === 'raras' ? 'var(--warning-orange)' : 
                            categoria === 'extraplanares' ? 'var(--accent-gold)' : 
                            'var(--error-red)' %>;
              color: white;
              padding: 0.2rem 0.8rem;
              border-radius: 15px;
              font-size: 0.7rem;
              font-weight: bold;
              text-transform: uppercase;
              margin-top: 0.5rem;
            ">
              <%= categoria === 'comuns' ? 'Comum' : 
                  categoria === 'raras' ? 'Rara' : 
                  categoria === 'extraplanares' ? 'Extraplanar' : 
                  'Monstruosa' %>
            </div>
          </div>
          
          <div class="raca-content">
            <p class="raca-descricao"><%= raca.descricao %></p>
            
            <% if (raca.bonus_atributos) { %>
              <div class="bonus-atributos">
                <h4>ğŸ’ª Modificadores de Atributo</h4>
                <div class="atributos-lista">
                  <% 
                    const bonus = typeof raca.bonus_atributos === 'string' ? 
                      JSON.parse(raca.bonus_atributos) : raca.bonus_atributos;
                    
                    if (bonus.livre) {
                  %>
                    <span class="bonus-item special">
                      <strong>Livre:</strong> +1 em <%= bonus.livre %> atributos diferentes
                      <% if (bonus.carisma && bonus.carisma < 0) { %>
                        (exceto Carisma)
                      <% } else if (bonus.constituicao && bonus.constituicao < 0) { %>
                        (exceto ConstituiÃ§Ã£o)
                      <% } %>
                    </span>
                    <% if (Object.keys(bonus).length > 1) { %>
                      <% Object.entries(bonus).forEach(([atributo, valor]) => { %>
                        <% if (atributo !== 'livre' && valor !== 0) { %>
                          <span class="bonus-item <%= valor > 0 ? 'positive' : 'negative' %>">
                            <strong><%= atributo.charAt(0).toUpperCase() + atributo.slice(1) %>:</strong> 
                            <%= valor > 0 ? '+' : '' %><%= valor %>
                          </span>
                        <% } %>
                      <% }); %>
                    <% } %>
                  <% } else { %>
                    <% Object.entries(bonus).forEach(([atributo, valor]) => { %>
                      <span class="bonus-item <%= valor > 0 ? 'positive' : 'negative' %>">
                        <strong><%= atributo.charAt(0).toUpperCase() + atributo.slice(1) %>:</strong> 
                        <%= valor > 0 ? '+' : '' %><%= valor %>
                      </span>
                    <% }); %>
                  <% } %>
                </div>
              </div>
            <% } %>
            
            <% if (raca.habilidades_raciais && raca.habilidades_raciais.length > 0) { %>
              <div class="habilidades-raciais">
                <h4>âœ¨ Habilidades Raciais</h4>
                <ul class="habilidades-lista">
                  <% raca.habilidades_raciais.forEach(habilidade => { %>
                    <li>
                      <% 
                        // Adicionar Ã­cones especÃ­ficos para habilidades conhecidas
                        let iconeHabilidade = 'âš¡';
                        if (habilidade.toLowerCase().includes('visÃ£o')) iconeHabilidade = 'ğŸ‘ï¸';
                        else if (habilidade.toLowerCase().includes('magia')) iconeHabilidade = 'ğŸ”®';
                        else if (habilidade.toLowerCase().includes('armadura')) iconeHabilidade = 'ğŸ›¡ï¸';
                        else if (habilidade.toLowerCase().includes('voo') || habilidade.toLowerCase().includes('asas')) iconeHabilidade = 'ğŸ¦‹';
                        else if (habilidade.toLowerCase().includes('Ã¡gua') || habilidade.toLowerCase().includes('aquÃ¡tico')) iconeHabilidade = 'ğŸŒŠ';
                        else if (habilidade.toLowerCase().includes('morte') || habilidade.toLowerCase().includes('esqueleto')) iconeHabilidade = 'ğŸ’€';
                        else if (habilidade.toLowerCase().includes('fogo') || habilidade.toLowerCase().includes('elemental')) iconeHabilidade = 'ğŸ”¥';
                        else if (habilidade.toLowerCase().includes('natureza') || habilidade.toLowerCase().includes('planta')) iconeHabilidade = 'ğŸŒ¿';
                        else if (habilidade.toLowerCase().includes('chifre') || habilidade.toLowerCase().includes('mordida')) iconeHabilidade = 'âš”ï¸';
                        else if (habilidade.toLowerCase().includes('sorte')) iconeHabilidade = 'ğŸ€';
                        else if (habilidade.toLowerCase().includes('engenhoso') || habilidade.toLowerCase().includes('invenÃ§Ã£o')) iconeHabilidade = 'ğŸ”§';
                      %>
                      <span class="habilidade-icon"><%= iconeHabilidade %></span>
                      <%= habilidade %>
                    </li>
                  <% }); %>
                </ul>
              </div>
            <% } %>
            
            <div class="raca-tips">
              <h4>ğŸ’¡ Ideal Para</h4>
              <p class="ideal-text">
                <% 
                  // SugestÃµes baseadas nos bÃ´nus de atributos
                  let sugestoes = [];
                  const bonus = typeof raca.bonus_atributos === 'string' ? 
                    JSON.parse(raca.bonus_atributos) : raca.bonus_atributos;
                  
                  if (bonus.livre) {
                    sugestoes.push('Qualquer classe (muito versÃ¡til)');
                  } else {
                    if (bonus.forca && bonus.forca > 0) sugestoes.push('Guerreiros', 'BÃ¡rbaros');
                    if (bonus.destreza && bonus.destreza > 0) sugestoes.push('Ladinos', 'Arqueiros');
                    if (bonus.constituicao && bonus.constituicao > 0) sugestoes.push('Tanques', 'Defensores');
                    if (bonus.inteligencia && bonus.inteligencia > 0) sugestoes.push('Arcanistas', 'Estudiosos');
                    if (bonus.sabedoria && bonus.sabedoria > 0) sugestoes.push('ClÃ©ricos', 'Druidas');
                    if (bonus.carisma && bonus.carisma > 0) sugestoes.push('Bardos', 'Diplomatas');
                  }
                  
                  if (sugestoes.length === 0) sugestoes.push('Personagens Ãºnicos e especializados');
                %>
                <%= sugestoes.slice(0, 4).join(', ') %>
              </p>
            </div>
          </div>
        </div>
      <% }); %>
    </div>
  <% } else { %>
    <div class="empty-state">
      <div class="card">
        <h3>ğŸ“‹ Nenhuma raÃ§a encontrada</h3>
        <p>NÃ£o foi possÃ­vel carregar as raÃ§as disponÃ­veis. Tente novamente mais tarde.</p>
      </div>
    </div>
  <% } %>

  <!-- Guia Detalhado por Categoria -->
  <div class="categorias-guide">
    <h2>ğŸ“š Guia das Categorias Raciais</h2>
    
    <div class="content-grid">
      <div class="card categoria-card comuns">
        <h3>ğŸ˜ï¸ RaÃ§as Comuns</h3>
        <p><strong>Mais numerosas e aceitas</strong></p>
        <ul>
          <li>ğŸŒ <strong>Bem integradas:</strong> Aceitas em toda Arton</li>
          <li>ğŸ¤ <strong>Sociais:</strong> FÃ¡cil interaÃ§Ã£o com outras raÃ§as</li>
          <li>ğŸ“ˆ <strong>Recomendadas:</strong> Ideais para iniciantes</li>
          <li>âš–ï¸ <strong>Equilibradas:</strong> Boas em vÃ¡rias classes</li>
        </ul>
        <div class="categoria-exemplos">
          <strong>Incluem:</strong> Humanos, Elfos, AnÃµes, Goblins, Minotauros...
        </div>
      </div>
      
      <div class="card categoria-card raras">
        <h3>âœ¨ RaÃ§as Raras</h3>
        <p><strong>Menos comuns, mais exÃ³ticas</strong></p>
        <ul>
          <li>ğŸ‘€ <strong>Curiosidade:</strong> Atraem atenÃ§Ã£o por onde passam</li>
          <li>ğŸ­ <strong>Roleplay:</strong> Oportunidades narrativas Ãºnicas</li>
          <li>âš¡ <strong>Especializadas:</strong> Habilidades muito especÃ­ficas</li>
          <li>ğŸ¯ <strong>AvanÃ§adas:</strong> Para jogadores experientes</li>
        </ul>
        <div class="categoria-exemplos">
          <strong>Incluem:</strong> Hynne, Golems, Kliren, Sereias...
        </div>
      </div>
      
      <div class="card categoria-card extraplanares">
        <h3>ğŸŒŸ RaÃ§as Extraplanares</h3>
        <p><strong>Origens divinas ou mÃ¡gicas</strong></p>
        <ul>
          <li>âœ¨ <strong>Poderes Ãºnicos:</strong> Habilidades sobrenaturais</li>
          <li>ğŸŒŒ <strong>Origem exÃ³tica:</strong> De outros planos de existÃªncia</li>
          <li>ğŸ­ <strong>Complexas:</strong> Requerem interpretaÃ§Ã£o cuidadosa</li>
          <li>âš–ï¸ <strong>Balanceadas:</strong> Poderes x limitaÃ§Ãµes</li>
        </ul>
        <div class="categoria-exemplos">
          <strong>Incluem:</strong> SÃ­lfides, Suraggel, Qareen...
        </div>
      </div>
      
      <div class="card categoria-card monstruosas">
        <h3>ğŸ‘¹ RaÃ§as Monstruosas</h3>
        <p><strong>AparÃªncia intimidadora</strong></p>
        <ul>
          <li>ğŸ˜° <strong>Temidas:</strong> Podem assustar NPCs</li>
          <li>ğŸ’ª <strong>Poderosas:</strong> Habilidades combativas Ãºnicas</li>
          <li>ğŸ­ <strong>Desafiadoras:</strong> Roleplay complexo</li>
          <li>âš”ï¸ <strong>Especializadas:</strong> Excelentes em nichos especÃ­ficos</li>
        </ul>
        <div class="categoria-exemplos">
          <strong>Incluem:</strong> Medusas, Osteon, Trogs...
        </div>
      </div>
    </div>
  </div>

  <!-- Dicas de CriaÃ§Ã£o -->
  <div class="creation-tips">
    <h2>ğŸ¯ Dicas para Escolha de RaÃ§a</h2>
    <div class="content-grid">
      <div class="card tip-card">
        <h4>ğŸ­ Conceito Primeiro</h4>
        <p>Pense na <strong>personalidade e histÃ³ria</strong> do personagem antes de escolher a raÃ§a. A mecÃ¢nica deve servir Ã  narrativa, nÃ£o o contrÃ¡rio.</p>
      </div>
      
      <div class="card tip-card">
        <h4>âš–ï¸ Equilibrio Ã© Fundamental</h4>
        <p>Todas as raÃ§as sÃ£o <strong>viÃ¡veis e equilibradas</strong>. NÃ£o hÃ¡ escolhas certas ou erradas, apenas estilos diferentes de jogo.</p>
      </div>
      
      <div class="card tip-card">
        <h4>ğŸ¤ Considere o Grupo</h4>
        <p>Pense em como sua raÃ§a se <strong>relacionarÃ¡ com outros personagens</strong> e NPCs na campanha do seu Mestre.</p>
      </div>
      
      <div class="card tip-card">
        <h4>ğŸ“ˆ EvoluÃ§Ã£o do Personagem</h4>
        <p>Considere como as <strong>habilidades raciais evoluirÃ£o</strong> com o tempo e como se complementarÃ£o com sua classe escolhida.</p>
      </div>
    </div>
  </div>

  <!-- Sistema de Modificadores -->
  <div class="modificadores-guide">
    <h2>ğŸ“Š Como Funcionam os Modificadores Raciais</h2>
    <div class="card">
      <div class="content-grid">
        <div class="exemplo-calculo">
          <h4>ğŸ’¡ Exemplo PrÃ¡tico</h4>
          <div style="background: rgba(37, 40, 80, 0.6); padding: 1rem; border-radius: 6px; margin: 1rem 0;">
            <p><strong>Antes do modificador racial:</strong></p>
            <p>ğŸ¯ Carisma = 12 (+1)</p>
            
            <p style="margin: 1rem 0;"><strong>Qareen (+2 Carisma):</strong></p>
            <p style="color: var(--accent-gold);">âœ¨ Carisma = 14 (+2)</p>
            
            <p style="font-size: 0.9rem; color: var(--text-muted); margin-top: 1rem;">
              <em>O bÃ´nus Ã© aplicado diretamente ao valor do atributo, nÃ£o como bÃ´nus separado!</em>
            </p>
          </div>
        </div>
        
        <div class="tipos-bonus">
          <h4>ğŸ”„ Tipos de Modificadores</h4>
          <ul style="list-style: none; padding: 0;">
            <li style="margin: 0.5rem 0;">
              <span style="color: var(--success-green);">âœ… <strong>BÃ´nus Fixos:</strong></span> 
              Aplicados automaticamente
            </li>
            <li style="margin: 0.5rem 0;">
              <span style="color: var(--warning-orange);">âš¡ <strong>BÃ´nus Livres:</strong></span> 
              VocÃª escolhe os atributos
            </li>
            <li style="margin: 0.5rem 0;">
              <span style="color: var(--error-red);">âŒ <strong>Penalidades:</strong></span> 
              Reduzem o valor do atributo
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- Call to Action -->
  <% if (user) { %>
    <div class="cta-section">
      <div class="card">
        <h3>ğŸ¨ Pronto para Criar?</h3>
        <p>Agora que vocÃª conhece todas as raÃ§as de Arton, que tal criar seu personagem Ã©pico?</p>
        <div class="cta-buttons">
          <a href="/personagens/criar" class="nav-btn">âœ¨ Criar Personagem</a>
          <a href="/classes" class="btn btn-secondary">âš”ï¸ Ver Classes</a>
        </div>
      </div>
    </div>
  <% } else { %>
    <div class="cta-section">
      <div class="card">
        <h3>ğŸš€ Comece Sua Aventura</h3>
        <p>FaÃ§a login para comeÃ§ar a criar seus personagens Ã©picos de Arton!</p>
        <div class="cta-buttons">
          <a href="/register" class="nav-btn">âœ¨ Criar Conta</a>
          <a href="/login" class="btn btn-secondary">ğŸ” Login</a>
        </div>
      </div>
    </div>
  <% } %>
</section>



<script>
// Script para filtros de raÃ§a
document.addEventListener('DOMContentLoaded', function() {
  const filterButtons = document.querySelectorAll('.filter-btn');
  const racaCards = document.querySelectorAll('.raca-card');
  
  filterButtons.forEach(button => {
    button.addEventListener('click', function() {
      // Remover classe active de todos os botÃµes
      filterButtons.forEach(btn => btn.classList.remove('active'));
      
      // Adicionar classe active ao botÃ£o clicado
      this.classList.add('active');
      
      // Filtrar raÃ§as
      const categoria = this.dataset.filter;
      
      racaCards.forEach(card => {
        if (categoria === 'all' || card.dataset.categoria === categoria) {
          card.classList.remove('hidden');
          card.style.animation = 'fadeInUp 0.5s ease-out';
        } else {
          card.classList.add('hidden');
        }
      });
    });
  });
  
  console.log('âœ… Sistema de filtros de raÃ§as carregado');
});
</script>

<%- include('../partials/footer') %>