<%- include('../partials/header', { title: 'Equipamentos', activePage: 'equipment' }) %>

<section class="content-section active">
  <h2>ğŸ›¡ï¸ Arsenal de Arton</h2>
  <p style="text-align: center; margin-bottom: 2rem; color: #b8b8b8;">
    Explore o vasto arsenal de armas, armaduras e equipamentos disponÃ­veis para equipar seus herÃ³is. Do simples ao Ã©pico, cada item tem seu lugar nas aventuras de Arton.
  </p>

  <!-- Filtros de Equipamento -->
  <div class="equipment-filters">
    <h3>ğŸ” Filtrar Equipamentos</h3>
    <div class="filter-controls">
      <div class="filter-group">
        <label>Tipo de Equipamento:</label>
        <select id="tipoFilter" class="filter-select">
          <option value="all">Todos os Tipos</option>
          <option value="arma">âš”ï¸ Armas</option>
          <option value="armadura">ğŸ›¡ï¸ Armaduras</option>
          <option value="escudo">ğŸ”° Escudos</option>
          <option value="acessorio">ğŸ’ AcessÃ³rios</option>
        </select>
      </div>
      
      <div class="filter-group">
        <label>Categoria:</label>
        <select id="categoriaFilter" class="filter-select">
          <option value="all">Todas as Categorias</option>
          <option value="simples">Simples</option>
          <option value="marcial">Marcial</option>
          <option value="leve">Leve</option>
          <option value="mÃ©dia">MÃ©dia</option>
          <option value="pesada">Pesada</option>
          <option value="defesa">Defesa</option>
          <option value="equipamento">Equipamento</option>
        </select>
      </div>
      
      <div class="filter-group">
        <label>Buscar:</label>
        <input type="text" id="searchFilter" class="filter-input" placeholder="Nome do item...">
      </div>
      
      <button id="clearFilters" class="btn btn-secondary">ğŸ”„ Limpar Filtros</button>
    </div>
  </div>

  <!-- Lista de Equipamentos -->
  <% if (equipamentosPorTipo && Object.keys(equipamentosPorTipo).length > 0) { %>
    <div class="equipment-container" id="equipmentContainer">
      <% Object.entries(equipamentosPorTipo).forEach(([tipo, equipamentos]) => { %>
        <div class="equipment-section" data-tipo="<%= tipo %>">
          <div class="section-header">
            <h3 class="section-title">
              <% 
                let tipoIcon = 'âš”ï¸';
                switch(tipo) {
                  case 'arma': tipoIcon = 'âš”ï¸'; break;
                  case 'armadura': tipoIcon = 'ğŸ›¡ï¸'; break;
                  case 'escudo': tipoIcon = 'ğŸ”°'; break;
                  case 'acessorio': tipoIcon = 'ğŸ’'; break;
                  default: tipoIcon = 'ğŸ“¦';
                }
              %>
              <%= tipoIcon %> <%= tipo.charAt(0).toUpperCase() + tipo.slice(1) %>s
            </h3>
            <span class="items-count">(<%= equipamentos.length %> itens)</span>
          </div>
          
          <div class="equipment-grid">
            <% equipamentos.forEach(item => { %>
              <div class="equipment-card" 
                   data-tipo="<%= item.tipo %>" 
                   data-categoria="<%= item.categoria %>"
                   data-nome="<%= item.nome.toLowerCase() %>">
                
                <div class="equipment-header">
                  <div class="equipment-icon">
                    <% 
                      let itemIcon = 'ğŸ“¦';
                      if (item.tipo === 'arma') {
                        if (item.categoria === 'marcial') itemIcon = 'âš”ï¸';
                        else if (item.nome.toLowerCase().includes('arco')) itemIcon = 'ğŸ¹';
                        else if (item.nome.toLowerCase().includes('adaga')) itemIcon = 'ğŸ—¡ï¸';
                        else if (item.nome.toLowerCase().includes('martelo')) itemIcon = 'ğŸ”¨';
                        else itemIcon = 'âš”ï¸';
                      } else if (item.tipo === 'armadura') {
                        if (item.categoria === 'leve') itemIcon = 'ğŸ§¥';
                        else if (item.categoria === 'pesada') itemIcon = 'ğŸ›¡ï¸';
                        else itemIcon = 'ğŸ‘•';
                      } else if (item.tipo === 'escudo') {
                        itemIcon = 'ğŸ”°';
                      } else {
                        itemIcon = 'ğŸ’';
                      }
                    %>
                    <%= itemIcon %>
                  </div>
                  <h4 class="equipment-name"><%= item.nome %></h4>
                  <p class="equipment-category"><%= item.categoria || 'PadrÃ£o' %></p>
                </div>
                
                <div class="equipment-content">
                  <div class="equipment-description">
                    <p><%= item.descricao %></p>
                  </div>
                  
                  <div class="equipment-stats">
                    <div class="stats-grid">
                      <% if (item.preco_tibares && item.preco_tibares > 0) { %>
                        <div class="stat-item">
                          <span class="stat-icon">ğŸ’°</span>
                          <span class="stat-label">PreÃ§o</span>
                          <span class="stat-value"><%= item.preco_tibares %> T$</span>
                        </div>
                      <% } %>
                      
                      <% if (item.peso && item.peso > 0) { %>
                        <div class="stat-item">
                          <span class="stat-icon">âš–ï¸</span>
                          <span class="stat-label">Peso</span>
                          <span class="stat-value"><%= item.peso %> kg</span>
                        </div>
                      <% } %>
                      
                      <% if (item.bonus_ca && item.bonus_ca > 0) { %>
                        <div class="stat-item">
                          <span class="stat-icon">ğŸ›¡ï¸</span>
                          <span class="stat-label">BÃ´nus CA</span>
                          <span class="stat-value">+<%= item.bonus_ca %></span>
                        </div>
                      <% } %>
                      
                      <% if (item.dano) { %>
                        <div class="stat-item">
                          <span class="stat-icon">ğŸ’¥</span>
                          <span class="stat-label">Dano</span>
                          <span class="stat-value"><%= item.dano %></span>
                        </div>
                      <% } %>
                      
                      <% if (item.alcance && item.alcance > 1) { %>
                        <div class="stat-item">
                          <span class="stat-icon">ğŸ¯</span>
                          <span class="stat-label">Alcance</span>
                          <span class="stat-value"><%= item.alcance %>m</span>
                        </div>
                      <% } %>
                    </div>
                  </div>
                  
                  <% if (item.propriedades && item.propriedades.length > 0) { %>
                    <div class="equipment-properties">
                      <h5>âœ¨ Propriedades</h5>
                      <div class="properties-list">
                        <% item.propriedades.forEach(prop => { %>
                          <span class="property-tag"><%= prop %></span>
                        <% }); %>
                      </div>
                    </div>
                  <% } %>
                </div>
              </div>
            <% }); %>
          </div>
        </div>
      <% }); %>
    </div>
  <% } else { %>
    <div class="empty-state">
      <div class="card">
        <h3>ğŸ“¦ Nenhum equipamento encontrado</h3>
        <p>NÃ£o foi possÃ­vel carregar os equipamentos disponÃ­veis. Tente novamente mais tarde.</p>
      </div>
    </div>
  <% } %>

  <!-- Guia de Equipamentos -->
  <div class="equipment-guide">
    <h2>ğŸ“š Guia de Equipamentos</h2>
    
    <div class="guide-sections">
      <div class="content-grid">
        <div class="card guide-card">
          <h3>âš”ï¸ Armas</h3>
          <h4>Categorias de Armas:</h4>
          <ul>
            <li><strong>Simples:</strong> FÃ¡ceis de usar, ideais para iniciantes</li>
            <li><strong>Marciais:</strong> Requerem treinamento, maior dano</li>
          </ul>
          
          <h4>Tipos Comuns:</h4>
          <ul>
            <li>ğŸ—¡ï¸ <strong>Espadas:</strong> VersÃ¡teis, corpo a corpo</li>
            <li>ğŸ¹ <strong>Arcos:</strong> Ataques Ã  distÃ¢ncia</li>
            <li>ğŸ”¨ <strong>Martelos:</strong> Alto dano, pesados</li>
            <li>ğŸ—¡ï¸ <strong>Adagas:</strong> Leves, podem ser arremessadas</li>
          </ul>
        </div>
        
        <div class="card guide-card">
          <h3>ğŸ›¡ï¸ Armaduras</h3>
          <h4>Categorias de Armadura:</h4>
          <ul>
            <li><strong>Leve:</strong> NÃ£o atrapalha movimento</li>
            <li><strong>MÃ©dia:</strong> EquilÃ­brio proteÃ§Ã£o/mobilidade</li>
            <li><strong>Pesada:</strong> MÃ¡xima proteÃ§Ã£o</li>
          </ul>
          
          <h4>ConsideraÃ§Ãµes:</h4>
          <ul>
            <li>ğŸ“Š <strong>CA:</strong> Classe de Armadura base</li>
            <li>ğŸƒ <strong>Destreza:</strong> Limite do bÃ´nus de Des</li>
            <li>âš–ï¸ <strong>Peso:</strong> Afeta carga e movimento</li>
          </ul>
        </div>
        
        <div class="card guide-card">
          <h3>ğŸ”° Escudos</h3>
          <h4>BenefÃ­cios:</h4>
          <ul>
            <li>ğŸ›¡ï¸ <strong>CA Extra:</strong> +2 de bÃ´nus</li>
            <li>ğŸ¤º <strong>Defesa Ativa:</strong> Bloqueio consciente</li>
            <li>âš”ï¸ <strong>Combate:</strong> Pode ser usado para atacar</li>
          </ul>
          
          <h4>RestriÃ§Ãµes:</h4>
          <ul>
            <li>ğŸ¤² <strong>MÃ£os:</strong> Ocupa uma mÃ£o</li>
            <li>ğŸ¯ <strong>ProficiÃªncia:</strong> NecessÃ¡ria para efetividade</li>
          </ul>
        </div>
        
        <div class="card guide-card">
          <h3>ğŸ’ AcessÃ³rios</h3>
          <h4>Itens UtilitÃ¡rios:</h4>
          <ul>
            <li>ğŸ’ <strong>Mochilas:</strong> Aumentam capacidade</li>
            <li>ğŸª¢ <strong>Cordas:</strong> Escaladas e travessias</li>
            <li>ğŸ•¯ï¸ <strong>Tochas:</strong> IluminaÃ§Ã£o</li>
            <li>ğŸ§ª <strong>PoÃ§Ãµes:</strong> Cura e efeitos especiais</li>
          </ul>
          
          <h4>Dica:</h4>
          <p>NÃ£o subestime itens mundanos! Uma corda pode salvar vidas em situaÃ§Ãµes crÃ­ticas.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Dicas de Escolha -->
  <div class="equipment-tips">
    <h2>ğŸ’¡ Dicas para Escolher Equipamentos</h2>
    <div class="content-grid">
      <div class="card tip-card">
        <h4>ğŸ’° OrÃ§amento Inicial</h4>
        <p>Personagens iniciantes tÃªm recursos limitados. Priorize:</p>
        <ul>
          <li>ğŸ›¡ï¸ <strong>ProteÃ§Ã£o bÃ¡sica</strong> (armadura simples)</li>
          <li>âš”ï¸ <strong>Arma principal</strong> adequada Ã  classe</li>
          <li>ğŸ’ <strong>Equipamentos de sobrevivÃªncia</strong></li>
        </ul>
      </div>
      
      <div class="card tip-card">
        <h4>âš–ï¸ Gerenciamento de Peso</h4>
        <p>Carga excessiva reduz movimento. Considere:</p>
        <ul>
          <li>ğŸ’ª <strong>ForÃ§a do personagem</strong></li>
          <li>ğŸ’ <strong>Capacidade da mochila</strong></li>
          <li>âš–ï¸ <strong>Peso vs. benefÃ­cio</strong> de cada item</li>
        </ul>
      </div>
      
      <div class="card tip-card">
        <h4>ğŸ¯ EspecializaÃ§Ã£o</h4>
        <p>Foque no estilo de sua classe:</p>
        <ul>
          <li>âš”ï¸ <strong>Guerreiros:</strong> Armas pesadas, armaduras</li>
          <li>ğŸ¹ <strong>Ladinos:</strong> Armas leves, itens utilitÃ¡rios</li>
          <li>ğŸ”® <strong>Arcanistas:</strong> Componentes mÃ¡gicos</li>
          <li>âœ¨ <strong>ClÃ©ricos:</strong> SÃ­mbolos sagrados, cura</li>
        </ul>
      </div>
      
      <div class="card tip-card">
        <h4>ğŸ“ˆ EvoluÃ§Ã£o</h4>
        <p>Planeje upgrades futuros:</p>
        <ul>
          <li>ğŸ’ <strong>Itens mÃ¡gicos</strong> substituem mundanos</li>
          <li>ğŸ”§ <strong>Melhorias</strong> em ferreiros</li>
          <li>ğŸ† <strong>Recompensas</strong> de aventuras</li>
          <li>ğŸ’° <strong>Economia</strong> para grandes compras</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Tabela de PreÃ§os -->
  <div class="pricing-reference">
    <h2>ğŸ’° ReferÃªncia de PreÃ§os</h2>
    <div class="card">
      <div class="pricing-grid">
        <div class="price-category">
          <h4>âš”ï¸ Armas Simples</h4>
          <ul>
            <li>Adaga: 20 T$</li>
            <li>BordÃ£o: 5 T$</li>
            <li>Clava: 1 T$</li>
            <li>Punhal: 20 T$</li>
          </ul>
        </div>
        
        <div class="price-category">
          <h4>âš”ï¸ Armas Marciais</h4>
          <ul>
            <li>Espada Longa: 200 T$</li>
            <li>Martelo de Guerra: 150 T$</li>
            <li>Arco Longo: 150 T$</li>
            <li>Machado de Batalha: 100 T$</li>
          </ul>
        </div>
        
        <div class="price-category">
          <h4>ğŸ›¡ï¸ Armaduras</h4>
          <ul>
            <li>Couro: 100 T$</li>
            <li>Couro Batido: 450 T$</li>
            <li>Cota de Malha: 500 T$</li>
            <li>Placas: 1.500 T$</li>
          </ul>
        </div>
        
        <div class="price-category">
          <h4>ğŸ’ Equipamentos</h4>
          <ul>
            <li>Mochila: 20 T$</li>
            <li>Corda (15m): 20 T$</li>
            <li>Tocha: 1 T$</li>
            <li>RaÃ§Ã£o (1 dia): 2 T$</li>
          </ul>
        </div>
      </div>
      
      <div class="pricing-note">
        <p><strong>ğŸ’¡ Nota:</strong> PreÃ§os podem variar conforme a regiÃ£o, disponibilidade e qualidade do item. T$ = Tibares (moeda de Arton)</p>
      </div>
    </div>
  </div>

  <!-- Call to Action -->
  <% if (user) { %>
    <div class="cta-section">
      <div class="card">
        <h3>âš”ï¸ Equipar Seus HerÃ³is</h3>
        <p>Agora que conhece os equipamentos, que tal criar um personagem bem equipado?</p>
        <div class="cta-buttons">
          <a href="/personagens/criar" class="nav-btn">âœ¨ Criar Personagem</a>
          <a href="/personagens" class="btn btn-secondary">ğŸ“‹ Meus Personagens</a>
        </div>
      </div>
    </div>
  <% } else { %>
    <div class="cta-section">
      <div class="card">
        <h3>ğŸš€ Aventure-se em Arton</h3>
        <p>Cadastre-se para criar personagens e equipÃ¡-los para grandes aventuras!</p>
        <div class="cta-buttons">
          <a href="/register" class="nav-btn">âœ¨ Criar Conta</a>
          <a href="/login" class="btn btn-secondary">ğŸ” Login</a>
        </div>
      </div>
    </div>
  <% } %>
</section>

<!-- Script especÃ­fico para equipamentos -->
<script src="/scripts/equipment.js"></script>

<%- include('../partials/footer') %>