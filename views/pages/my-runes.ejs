<%- include('../partials/header', { title: 'Minhas Runas', activePage: 'myRunes' }) %>

<section class="content-section active">
  <h2>Minhas P√°ginas de Runas</h2>
  
  <div class="my-runes-actions">
    <a href="/runes/builder" class="nav-btn">‚ú® Criar Nova P√°gina de Runas</a>
  </div>
  
  <% if (runePages && runePages.length > 0) { %>
    <div class="rune-pages-grid">
      <% runePages.forEach(runePage => { %>
        <div class="rune-page-card" data-id="<%= runePage.id %>">
          <!-- Header com nome e data -->
          <div class="rune-page-header">
            <h3><%= runePage.name %></h3>
            <div class="rune-page-meta">
              <span class="created-at">üìÖ <%= new Date(runePage.created_at).toLocaleDateString('pt-BR') %></span>
              <button class="delete-rune-btn" data-id="<%= runePage.id %>" title="Excluir p√°gina">üóëÔ∏è</button>
            </div>
          </div>
          
          <!-- Layout das Runas -->
          <div class="rune-layout">
            <!-- Se√ß√£o das √Årvores -->
            <div class="trees-section">
              <div class="primary-tree-header">
                <img src="/assets/runes/<%= getTreeImageName(runePage.primary_tree) %>.png" alt="<%= runePage.primary_tree %>" class="tree-icon">
                <div class="tree-info">
                  <span class="tree-name"><%= getTreeName(runePage.primary_tree) %></span>
                  <span class="tree-type">Prim√°ria</span>
                </div>
              </div>
              <div class="secondary-tree-header">
                <img src="/assets/runes/<%= getTreeImageName(runePage.secondary_tree) %>.png" alt="<%= runePage.secondary_tree %>" class="tree-icon">
                <div class="tree-info">
                  <span class="tree-name"><%= getTreeName(runePage.secondary_tree) %></span>
                  <span class="tree-type">Secund√°ria</span>
                </div>
              </div>
            </div>
            
            <!-- Se√ß√£o das Runas -->
            <div class="runes-section">
              <!-- Coluna Prim√°ria -->
              <div class="primary-runes">
                <!-- Keystone -->
                <div class="keystone-rune">
                  <img src="/assets/runes/<%= runePage.primary_tree %>/<%= runePage.primary_keystone %>.png" 
                       alt="<%= runePage.primary_keystone %>" 
                       class="rune-icon keystone-icon"
                       onerror="this.src='/assets/runes/placeholder.png'">
                  <span class="rune-name keystone-name"><%= formatRuneName(runePage.primary_keystone) %></span>
                </div>
                
                <!-- Runas Prim√°rias -->
                <div class="primary-minor-runes">
                  <div class="minor-rune">
                    <img src="/assets/runes/<%= runePage.primary_tree %>/<%= runePage.primary_slot1 %>.png" 
                         alt="<%= runePage.primary_slot1 %>" 
                         class="rune-icon"
                         onerror="this.src='/assets/runes/placeholder.png'">
                    <span class="rune-name"><%= formatRuneName(runePage.primary_slot1) %></span>
                  </div>
                  <div class="minor-rune">
                    <img src="/assets/runes/<%= runePage.primary_tree %>/<%= runePage.primary_slot2 %>.png" 
                         alt="<%= runePage.primary_slot2 %>" 
                         class="rune-icon"
                         onerror="this.src='/assets/runes/placeholder.png'">
                    <span class="rune-name"><%= formatRuneName(runePage.primary_slot2) %></span>
                  </div>
                  <div class="minor-rune">
                    <img src="/assets/runes/<%= runePage.primary_tree %>/<%= runePage.primary_slot3 %>.png" 
                         alt="<%= runePage.primary_slot3 %>" 
                         class="rune-icon"
                         onerror="this.src='/assets/runes/placeholder.png'">
                    <span class="rune-name"><%= formatRuneName(runePage.primary_slot3) %></span>
                  </div>
                </div>
              </div>
              
              <!-- Coluna Secund√°ria -->
              <div class="secondary-runes">
                <div class="secondary-minor-runes">
                  <div class="minor-rune">
                    <img src="/assets/runes/<%= runePage.secondary_tree %>/<%= runePage.secondary_slot1 %>.png" 
                         alt="<%= runePage.secondary_slot1 %>" 
                         class="rune-icon"
                         onerror="this.src='/assets/runes/placeholder.png'">
                    <span class="rune-name"><%= formatRuneName(runePage.secondary_slot1) %></span>
                  </div>
                  <div class="minor-rune">
                    <img src="/assets/runes/<%= runePage.secondary_tree %>/<%= runePage.secondary_slot2 %>.png" 
                         alt="<%= runePage.secondary_slot2 %>" 
                         class="rune-icon"
                         onerror="this.src='/assets/runes/placeholder.png'">
                    <span class="rune-name"><%= formatRuneName(runePage.secondary_slot2) %></span>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Fragmentos Estat√≠sticos -->
            <div class="shards-section">
              <h5>üíé Fragmentos</h5>
              <div class="shards-list">
                <div class="shard-item">
                  <img src="/assets/shards/<%= runePage.shard1 %>.png" 
                       alt="<%= runePage.shard1 %>" 
                       class="shard-icon"
                       onerror="this.src='/assets/shards/placeholder.png'">
                  <span><%= formatShardName(runePage.shard1) %></span>
                </div>
                <div class="shard-item">
                  <img src="/assets/shards/<%= runePage.shard2 %>.png" 
                       alt="<%= runePage.shard2 %>" 
                       class="shard-icon"
                       onerror="this.src='/assets/shards/placeholder.png'">
                  <span><%= formatShardName(runePage.shard2) %></span>
                </div>
                <div class="shard-item">
                  <img src="/assets/shards/<%= runePage.shard3 %>.png" 
                       alt="<%= runePage.shard3 %>" 
                       class="shard-icon"
                       onerror="this.src='/assets/shards/placeholder.png'">
                  <span><%= formatShardName(runePage.shard3) %></span>
                </div>
              </div>
            </div>
          </div>
        </div>
      <% }); %>
    </div>
  <% } else { %>
    <div class="empty-rune-pages">
      <div class="card">
        <h3>üìù Nenhuma p√°gina de runas encontrada</h3>
        <p>Voc√™ ainda n√£o criou nenhuma p√°gina de runas. Comece criando uma nova p√°gina personalizada!</p>
        <a href="/runes/builder" class="nav-btn">‚ú® Criar Primeira P√°gina</a>
      </div>
    </div>
  <% } %>
</section>

<script src="/scripts/my-runes.js"></script>
<%- include('../partials/footer') %>

<%
// Fun√ß√£o para mapear nomes das √°rvores para imagens
function getTreeImageName(treeId) {
  const treeMap = {
    'precisao': 'precision',
    'dominacao': 'domination', 
    'feiticaria': 'sorcery',
    'determinacao': 'resolve',
    'inspiracao': 'inspiration'
  };
  return treeMap[treeId] || treeId;
}

// Fun√ß√£o para obter nomes das √°rvores em portugu√™s
function getTreeName(treeId) {
  const trees = {
    'precisao': 'Precis√£o',
    'dominacao': 'Domina√ß√£o',
    'feiticaria': 'Feiti√ßaria',
    'determinacao': 'Determina√ß√£o',
    'inspiracao': 'Inspira√ß√£o'
  };
  return trees[treeId] || treeId;
}

// Fun√ß√£o para formatar nomes das runas
function formatRuneName(runeName) {
  if (!runeName) return '';
  
  const runeNames = {
    // Keystones
    'press_the_attack': 'Pressione o Ataque',
    'lethal_tempo': 'Ritmo Fatal',
    'fleet_footwork': 'Agilidade nos P√©s',
    'conqueror': 'Conquistador',
    'electrocute': 'Eletrocutar',
    'dark_harvest': 'Colheita Sombria',
    'hail_of_blades': 'Chuva de L√¢minas',
    'arcane_comet': 'Cometa Arcano',
    'summon_aery': 'Invocar Aery',
    'phase_rush': '√çmpeto Gradual',
    'grasp_of_the_undying': 'Aperto dos Mortos-vivos',
    'aftershock': 'P√≥s-Choque',
    'guardian': 'Guardi√£o',
    'glacial_augment': 'Aprimoramento Glacial',
    'unsealed_spellbook': 'Livro de Feiti√ßos Deslacrado',
    'first_strike': 'Primeiro Ataque',
    
    // Runas Menores
    'absorb_life': 'Absors√£o Vital',
    'triumph': 'Triunfo',
    'presence_of_mind': 'Presen√ßa de Esp√≠rito',
    'legend_alacrity': 'Lenda: Espontaneidade',
    'legend_haste': 'Lenda: Acelera√ß√£o',
    'legend_bloodline': 'Lenda: Linhagem',
    'coup_de_grace': 'Golpe de Miseric√≥rdia',
    'cut_down': 'Dilacerar',
    'last_stand': 'At√© a Morte',
    'cheap_shot': 'Golpe Desleal',
    'taste_of_blood': 'Gosto de Sangue',
    'sudden_impact': 'Impacto Repentino',
    'sixth_sense': 'Sexto Sentido',
    'grisly_mementos': 'Lembran√ßa Aterrorizante',
    'deep_ward': 'Sentinela Profunda',
    'treasure_hunter': 'Ca√ßador de Tesouros',
    'relentless_hunter': 'Ca√ßador Incans√°vel',
    'ultimate_hunter': 'Ca√ßador Supremo'
  };
  
  return runeNames[runeName] || runeName.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
}

// Fun√ß√£o para formatar nomes dos fragmentos
function formatShardName(shardName) {
  if (!shardName) return '';
  
  const shardNames = {
    'adaptive_force': 'For√ßa Adaptativa',
    'attack_speed': 'Velocidade de Ataque',
    'ability_haste': 'Acelera√ß√£o de Habilidade',
    'movement_speed': 'Velocidade de Movimento',
    'health_bonus': 'Vida Escal√°vel',
    'health': 'Vida',
    'tenacity': 'Tenacidade'
  };
  
  return shardNames[shardName] || shardName.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
}
%>